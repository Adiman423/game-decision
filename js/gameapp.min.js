var timeInMs=Date.now(),igdb_api="https://igdbcom-internet-game-database-v1.p.mashape.com/games/";if(igdb_api+="?filter%5Brelease_dates.platform%5D%5Beq%5D=6",igdb_api+="&fields=name%2crating%2caggregated_rating%2crelease_dates%2curl%2calternative_names%2ccover.cloudinary_id&limit=10&offset=0%3Adesc&search=",navigator.userAgent.match(/IEMobile\/10\.0/)){var msViewportStyle=document.createElement("style");msViewportStyle.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(msViewportStyle)}var gameSearchApp=angular.module("gameJudgement",[]);gameSearchApp.controller("gameSearchCtrl",["$http","$scope",function($http,$scope){function altNameChecker(){for(var counter=0,i=0;i<searchctrl.steamList.length;i++)for(var j=0;j<searchctrl.games.length;j++)if(null!=searchctrl.games[j].alternative_names)for(var k=0;k<searchctrl.games[j].alternative_names.length;k++)searchctrl.games[j].alternative_names[k].name==searchctrl.steamList[i].name&&(counter++,console.log("matched an alt name"));return 0==counter&&console.log("no match found"),counter}function gameNameCleaner(){for(var i=0;i<searchctrl.steamList.length;i++)for(var j=0;j<searchctrl.games.length;j++)searchctrl.games[j].name.toLowerCase()==searchctrl.steamList[i].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.games[j].name.toLowerCase()==searchctrl.steamList[i].name.trim().toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.games[j].name.replace(": "," ").toLowerCase()===searchctrl.steamList[i].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.games[j].name.replace(": "," - ").toLowerCase()===searchctrl.steamList[i].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.games[j].name.replace("and","&")==searchctrl.steamList[i].name?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("_"," ")===searchctrl.games[j].name&&0==altNameChecker()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("®","").replace("™","").toLowerCase()==searchctrl.games[j].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("®","").toLowerCase()==searchctrl.games[j].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("™","").toLowerCase()==searchctrl.games[j].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("™","").toLowerCase().trim()==searchctrl.games[j].name.toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.steamList[i].name.replace("™","").toLowerCase()==searchctrl.games[j].name.replace(": "," ").toLowerCase()?searchctrl.games[j].name=searchctrl.steamList[i].name:searchctrl.games[j].name.toUpperCase()==searchctrl.steamList[i].name&&(searchctrl.games[j].name=searchctrl.steamList[i].name)}var searchctrl=this;searchctrl.rightNow=timeInMs,searchctrl.games={},searchctrl.steamList=[],$http.defaults.headers.common["X-Mashape-Key"]="MY_IGDB_API_KEY",$scope.target=parseInt(document.getElementById("target").value,10),$scope.target||($scope.target=75),$http.get("/steamList.json").success(function(data,status,headers,config){searchctrl.steamList=data,gameNameCleaner()});var clickCounter=0;$scope.search=function(search){clickCounter++;var formButtons=document.getElementById("form_buttons");clickCounter>=1&&(formButtons.innerHTML='<a class="btn btn-primary" href="/">Start Over</a>');var invalidGameName=document.getElementById("invalidGameName");search=document.getElementById("search").value;var isAlphaNumeric=function(str){var code,i,len;for(i=0,len=str.length;i<len;i++)if(code=str.charCodeAt(i),!(code>47&&code<58||code>64&&code<91||code>96&&code<123||code>=128&&code<=155||157==code||58==code||38==code||39==code||95==code||45==code||code>=160&&code<=165||code>=181&&code<=183||198==code&&199==code||code>=208&&code<=212||code>=214&&code<=216||code>=224&&code<=229||code>=233&&code<=237||32==code))return!1;return!0};if(0==isAlphaNumeric(search)||search.length>140)return invalidGameName.innerHTML="The game name you entered was too long or invalid.",void(formButtons.innerHTML='<a class="btn btn-primary" href="/">Try Again</a>');if(0==search.length)return invalidGameName.innerHTML="You did not enter a game to search for!",void(formButtons.innerHTML='<a class="btn btn-primary" href="/">Try Again</a>');var target=document.getElementById("target").value,numbers=/^[0-9]+$/,invalidNumber=document.getElementById("invalidNumber");return target.match(numbers)||0==target.length?($scope.target=parseInt(target,10),$scope.target||($scope.target=75),$scope.target<0||$scope.target>=101?(invalidNumber.innerHTML="Your threshold must be between 1 and 100",void(formButtons.innerHTML='<a class="btn btn-primary" href="/">Try Again</a>')):(igdb_api+=document.getElementById("search").value,void $http.get(igdb_api,{headers:{"X-Mashape-Key":"MY_IGDB_API_KEY",Accept:"application/json"}}).success(function(data,status,headers,config){searchctrl.games=data,gameNameCleaner()}))):(invalidNumber.innerHTML="You did not type in a number.",void(formButtons.innerHTML='<a class="btn btn-primary" href="/">Try Again</a>'))}}]);